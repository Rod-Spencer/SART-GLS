<UserControl x:Class="Segway.Service.SART.BlackBox_Open_Control"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:wpfres="clr-namespace:Segway.WPFResources;assembly=WPFResources"
             xmlns:PresentationOptions="http://schemas.microsoft.com/winfx/2006/xaml/presentation/options"
             xmlns:shared="http://schemas.actiprosoftware.com/winfx/xaml/shared"
             xmlns:local="clr-namespace:Segway.Service.SART"
             xmlns:themes="http://schemas.actiprosoftware.com/winfx/xaml/themes"
             xmlns:Microsoft_Windows_Themes="clr-namespace:Microsoft.Windows.Themes;assembly=PresentationFramework.Aero"
             xmlns:i="http://schemas.microsoft.com/expression/2010/interactivity"
             xmlns:header="http://service.segway.com/schemas/Header/"
             mc:Ignorable="d" 
             d:DesignHeight="450" d:DesignWidth="1000"
             KeyboardNavigation.TabNavigation="Local" KeyboardNavigation.ControlTabNavigation="Local"
             VerticalAlignment="Stretch"
             >

    <UserControl.Resources>

    </UserControl.Resources>


    <Grid HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="1*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>


        <Popup Grid.Row="1" Grid.RowSpan="1" Grid.Column="1" Grid.ColumnSpan="1" Width="Auto" Height="Auto"
               IsOpen="{Binding Path=PopupOpen, Mode=TwoWay}" StaysOpen="False" Placement="Center">
            <Border Width="1000" Height="Auto" Background="{Binding Path=PopupColor, Mode=TwoWay}" BorderBrush="Black" BorderThickness="2"  >
                <ScrollViewer HorizontalScrollBarVisibility="Auto" VerticalScrollBarVisibility="Auto">
                    <TextBlock Text="{Binding Path=PopupMessage, Mode=TwoWay}" FontSize="16" Margin="40,25" HorizontalAlignment="Center" />
                </ScrollViewer>
            </Border>
        </Popup>


        <Popup Grid.Row="1" Grid.RowSpan="1" Grid.Column="1" Grid.ColumnSpan="1" Width="800" Height="300"
        IsOpen="{Binding Path=GraphSelect_PopupOpen, Mode=TwoWay}" StaysOpen="True" Placement="Center">
            <Border Background="LightGray" BorderBrush="Black" BorderThickness="2" >
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*" />
                        <RowDefinition Height="200" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition />
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="2*"/>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition />
                    </Grid.ColumnDefinitions>

                    <TextBlock  Grid.Row="0" Grid.Column="1" Text="Graph Names" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Bottom"/>
                    <TextBlock  Grid.Row="0" Grid.Column="3" Text="Selected Graphs" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Bottom"/>
                    <ListBox Grid.Row="1" Grid.Column="1" FontSize="15" 
                             ItemsSource="{Binding Path=Graph_Defs, Mode=TwoWay}"  SelectedItem="{Binding Path=Selected_GraphDef}" 
                             ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                    <ListBox Grid.Row="1" Grid.Column="3" FontSize="15"
                             ItemsSource="{Binding Path=Graph_Sels, Mode=TwoWay}" SelectedItem="{Binding Path=Selected_GraphSel}" 
                             ScrollViewer.HorizontalScrollBarVisibility="Auto" ScrollViewer.VerticalScrollBarVisibility="Auto"/>
                    <StackPanel  Grid.Row="1" Grid.Column="2" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Button Content=">>>" Height="30" Width="50" FontSize="20" Margin="0,5"  Command="{Binding AddAllGraphCommand}" ToolTip="Add All"/>
                        <Button Content=">>" Height="30" Width="50" FontSize="20" Margin="0,5"  Command="{Binding AddGraphCommand}" ToolTip="Add Selected"/>
                        <Button Content="&lt;&lt;" Height="30" Width="50" FontSize="20" Margin="0,5" Command="{Binding RemGraphCommand}" ToolTip="Remove Selected"/>
                        <Button Content="&lt;&lt;&lt;" Height="30" Width="50" FontSize="20" Margin="0,5" Command="{Binding RemAllGraphCommand}" ToolTip="Remove All"/>
                    </StackPanel>

                    <StackPanel  Grid.Row="2" Grid.Column="1" Grid.ColumnSpan="3" Orientation="Horizontal" HorizontalAlignment="Center" VerticalAlignment="Center">
                        <Button Content="Graph"  Height="30" Width="150" FontSize="20" Margin="20,0"  Command="{Binding DrawGraphCommand}" ToolTip="Add All"/>
                        <Button Content="Cancel" Height="30" Width="150" FontSize="20" Margin="20,0"  Command="{Binding CancelCommand}" ToolTip="Add Selected"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Popup>



        <header:Header_Bar_Control Grid.Row="0" HeaderText="Open Event Log" Header_FontSize="16" Header_ImageSource="{Binding Path=Header_Image}" />
        <DockPanel Grid.Row="1" MinHeight="345" DataContext="{Binding}" VerticalAlignment="Stretch" LastChildFill="True" HorizontalAlignment="Stretch">
            <shared:AnimatedExpander DockPanel.Dock="Top" Grid.ColumnSpan="2" HorizontalAlignment="Stretch" 
                                     Width="Auto" Height="Auto"
                                     VerticalAlignment="Stretch" Margin="5" IsExpanded="{Binding Path=IsExpanded, Mode=TwoWay}"
                                     IsAutoFocusOnExpandEnabled="True" Header="Filter Settings"
                                     IsAutoExpandOnFocusEnabled="False"
                                     IsAutoCollapseOnBlurEnabled="False" 
                                     Style="{DynamicResource {ComponentResourceKey ResourceId=ExpanderStyleOne, TypeInTargetAssembly={x:Type wpfres:Expanders}}}"
                                     >
                <local:BlackBox_Open_Settings_Control dpWorkOrder="{Binding Path=WorkOrderNumber, Mode=TwoWay}" 
                                                      dpPTSerial="{Binding Path=PTSerialNumber, Mode=TwoWay}"
                                                      dpBSASerial="{Binding Path=BSASerialNumber, Mode=TwoWay}"
                                                      dpApplyCommand="{Binding ApplyCommand}" dpClearCommand="{Binding ClearCommand}"
                                                      x:Name="viewSettings" VerticalAlignment="Top" HorizontalAlignment="Stretch" />
            </shared:AnimatedExpander>
            <ListView DockPanel.Dock="Top" HorizontalAlignment="Stretch" VerticalAlignment="Stretch"
                      ScrollViewer.CanContentScroll="True" Margin="5,0,5,10" Name="BB_List"
                      ItemContainerStyle="{DynamicResource {ComponentResourceKey ResourceId=ListViewItemStyleBlackBox, TypeInTargetAssembly={x:Type wpfres:ListViews}}}"
                      BorderThickness="1" FontFamily="Tahoma"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                      Style="{DynamicResource {ComponentResourceKey ResourceId=ListViewStyleOne, TypeInTargetAssembly={x:Type wpfres:ListViews}}}"
                      BorderBrush="{DynamicResource {ComponentResourceKey ResourceId=ControlBorderBrush, TypeInTargetAssembly={x:Type wpfres:Brushes}}}"                      
                      ItemsSource="{Binding Path=BlackBox_List, Mode=OneWay}"
                      SelectedItem="{Binding Path=Selected_BlackBox, Mode=TwoWay}"      
                      SelectionChanged="BB_List_SelectionChanged"
                      wpfres:GridViewSort.AutoSort="True"
                      wpfres:GridViewSort.ShowSortGlyph="True"
                      >
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="MouseDoubleClick">
                        <i:InvokeCommandAction Command="{Binding BlackBoxOpenCommand}"/>
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <ListView.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Merge Logs" Command="{Binding BlackBoxMergeCommand}" />
                        <!--<MenuItem Header="Save to Folder" Command="{Binding LocalSaveCommand}" />-->
                    </ContextMenu>
                </ListView.ContextMenu>
                <ListView.View>
                    <GridView AllowsColumnReorder="True"
                              ColumnHeaderContainerStyle="{DynamicResource {ComponentResourceKey ResourceId=GridViewColumnHeaderStyleOne, TypeInTargetAssembly={x:Type wpfres:ListViews}}}">
                        <GridViewColumn Header="Work Order Number" DisplayMemberBinding="{Binding Path=Work_Order}"  Width="150" wpfres:GridViewSort.PropertyName="Work_Order"/>
                        <GridViewColumn Header="PT Serial Number" DisplayMemberBinding="{Binding Path=Unit_ID_Serial_Number}"  Width="150" wpfres:GridViewSort.PropertyName="Unit_ID_Serial_Number"/>
                        <GridViewColumn Header="BSA Serial Number" DisplayMemberBinding="{Binding Path=BSA_Serial_Number}" Width="150" wpfres:GridViewSort.PropertyName="BSA_Serial_Number"/>
                        <GridViewColumn Header="Side" DisplayMemberBinding="{Binding Path=Side}"  Width="50" wpfres:GridViewSort.PropertyName="Side"/>
                        <GridViewColumn Header="User" DisplayMemberBinding="{Binding Path=User_Name}" Width="150" wpfres:GridViewSort.PropertyName="User_Name"/>
                        <GridViewColumn Header="Extracted" DisplayMemberBinding="{Binding Path=Date_Time_Entered}" Width="175" wpfres:GridViewSort.PropertyName="Date_Time_Entered"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </DockPanel>
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Left" Margin="10,0,0,0">
            <TextBlock Text="Count: " FontFamily="Tahoma" FontSize="14" Opacity="0.65">
                <TextBlock.Effect>
                    <DropShadowEffect BlurRadius="4" Opacity="0.5"/>
                </TextBlock.Effect>
            </TextBlock>
            <TextBlock Text="{Binding Path=Log_Count, Mode=OneWay}" FontFamily="Tahoma" FontSize="14" Opacity="0.65">
                <TextBlock.Effect>
                    <DropShadowEffect BlurRadius="4" Opacity="0.5"/>
                </TextBlock.Effect>
            </TextBlock>
        </StackPanel>

        <StackPanel Grid.Row="2" HorizontalAlignment="Right"  Orientation="Horizontal">
            <Button Width="120" Height="30" Content="Report" Command="{Binding BlackBoxOpenCommand}"
                Style="{DynamicResource {ComponentResourceKey ResourceId=ButtonStyleOne, TypeInTargetAssembly={x:Type wpfres:Buttons}}}"
                Margin="10,0,15,10" >
                <Button.Effect>
                    <DropShadowEffect BlurRadius="4" Opacity="0.5"/>
                </Button.Effect>
            </Button>

            <Button Width="120" Height="30" Content="Graph" Command="{Binding BlackBoxGraphCommand}"
                Style="{DynamicResource {ComponentResourceKey ResourceId=ButtonStyleOne, TypeInTargetAssembly={x:Type wpfres:Buttons}}}"
                Margin="10,0,15,10" >
                <Button.Effect>
                    <DropShadowEffect BlurRadius="4" Opacity="0.5"/>
                </Button.Effect>
            </Button>
        </StackPanel>
    </Grid>
</UserControl>
